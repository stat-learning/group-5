
```{r}
library(tidyverse)
library(dplyr)
happy_country
```


EXPLORATORY ANALYSIS
```{r}
eastern_europe <- filter(happy_country, Region == "EASTERN EUROPE")
eastern_europe_nocat <- subset(eastern_europe, select = -c(Region, Country, Climate))
eastern_europe_cor <- eastern_europe_nocat %>%
  cor(eastern_europe_nocat)
```

```{r}
western_europe <- filter(happy_country, Region == "WESTERN EUROPE")
western_europe_nocat <- subset(western_europe, select = -c(Region, Country, Climate))
western_europe_cor <- western_europe_nocat %>%
  cor(western_europe_nocat)
```
  
```{r}
#Latin America and Caribbean Region
latin_america_carib <- filter(happy_country, Region == "LATIN AMER. & CARIB")
latin_america_carib_nocat <- subset(latin_america_carib, select = -c(Region, Country, Climate))
latin_america_carib_cor <- latin_america_carib_nocat %>%
  cor(latin_america_carib_nocat)
```
Top Correlated Variables: Phonesper1000 (0.7221507), GDP_percapita (0.6595595), Literacy (0.6108366)
```{r}
#Linear Model to Predict Latin America and Caribbean Happiness
LACablm <- lm(HappinessScore ~ Phonesper1000 + Deathrate + Crops + 
                Arable, data = latin_america_carib)
summary(LACablm)
```
Adjusted R-squared:  0.8094
p-value: 4.992e-06

```{r}
# Africa Region
happy_country2 <- happy_country
happy_country2$Region[happy_country2$Region == "NORTHERN AFRICA"] <- "AFRICA"
happy_country2$Region[happy_country2$Region == "SUB-SAHARAN AFRICA"] <- "AFRICA"
africa <- filter(happy_country2, Region == "AFRICA")
africa_nocat <- subset(africa, select = -c(Region, Country, Climate))
africa_cor <- africa_nocat %>%
  cor(africa_nocat)
```
Top Correlated Variables: Phonesper1000 (0.53851034), GDP_percapita (0.43636820), Birthrate (-0.43576128).
```{r}
#Linear Model to Predict Africa Happiness
Africalm <- lm(HappinessScore ~ Phonesper1000 + Birthrate + Crops + 
                 PercievedCorruptionScore, data = africa)
summary(Africalm)
```
Adjusted R-squared:  0.3706
p-value: 0.00113

```{r}
# ASIA (EX. NEAR EAST) Region
asiaNE <- filter(happy_country2, Region == "ASIA (EX. NEAR EAST)")
asiaNE_nocat <- subset(asiaNE, select = -c(Region, Country, Climate))
asiaNE_cor <- asiaNE_nocat %>%
  cor(asiaNE_nocat)
```
Top Correlated Variables: Agriculture (-0.82178348), PercievedCorruptionScore (0.66801346), GDP_percapita (0.66188480).
```{r}
#Linear Model to Predict ASIA (EX. NEAR EAST) Happiness
asiaNElm <- lm(HappinessScore ~ Agriculture + Phonesper1000 + Birthrate +
                 GDP_percapita, data = asiaNE)
summary(asiaNElm)
```
Adjusted R-squared: 0.6589 
p-value: 0.001531

```{r}
#Happiness Score sorted by Region
RegionPlot<- ggplot(happy_country, aes(x = Region, y = HappinessScore)) +
 geom_point() +
 labs(x="Region", y="Happiness Score")
RegionPlot
```


LINEAR MODELS
```{r}
#Region Linear Model
alymod<- lm(HappinessScore ~ Region, data = happy_country)
summary(alymod)
```
Adjusted R-squared: 0.5754
```{r}
#Region + GDP + Infant Mortality + Percieved Corruption
alymod2 <- lm(HappinessScore ~ Region + GDP_percapita +
                Infantmortalityper1000births + PercievedCorruptionScore,
              data = happy_country)
summary(alymod2)
```
Adjusted R-squared: 0.7558
```{r}
#Region + GDP + Arable Land + Percieved Corruption
alymod3 <- lm(HappinessScore ~ Region + GDP_percapita + Arable + 
                PercievedCorruptionScore, data = happy_country)
summary(alymod3)
```
Adjusted R-squared: 0.7590
```{r}
#Region + GDP + Arable Land + Infant Mortality
alymod4 <- lm(HappinessScore ~ Region + GDP_percapita + Arable + 
                Infantmortalityper1000births, data = happy_country)
summary(alymod4)
```
Adjusted R-squared: 0.7627
```{r}
#Region + GDP + Arable Land + Infant Mortality + Percieved Corruption
alymod5 <- lm(HappinessScore ~ Region + GDP_percapita + Arable + 
              Infantmortalityper1000births + PercievedCorruptionScore, 
              data = happy_country)
summary(alymod5)
```
Adjusted R-squared: 0.7644
```{r}
#Region + GDP + Arable Land + Infant Mortality + Percieved Corruption + Coastline Area
alymod6 <- lm(HappinessScore ~ Region + GDP_percapita + Arable + 
              Infantmortalityper1000births + PercievedCorruptionScore + 
                Coastlinecoastbyarearatio, data = happy_country)
summary(alymod6)
```
Adjusted R-squared: 0.7648 

NORMALITY
```{r}
#GDP + Arable Land + Infant Mortality + Percieved Corruption
alymod7 <- lm(HappinessScore ~ GDP_percapita + Arable + 
              Infantmortalityper1000births + PercievedCorruptionScore, 
                data = happy_country)
summary(alymod7)
```

TRAINING/TESTING
```{r}
set.seed(1)
trainS <- sample(1:nrow(happy_country), nrow(happy_country) * .75)
trainD <- happy_country[trainS, ]
testD <- happy_country[-trainS, ]
```

```{r}
#Train 1
linearmodel1 <- lm(HappinessScore ~ Region + GDP_percapita + Arable + 
              Infantmortalityper1000births + PercievedCorruptionScore + 
                Coastlinecoastbyarearatio, data = trainD)
summary(linearmodel1)
```
```{r}
#Test 1
predict(linearmodel1, newdata = testD)
training_MSE <- mean(linearmodel1$residuals^2)
training_MSE
```
```{r}
#Residuals 1
par(mfrow = c(1, 2))
plot(linearmodel1, 1:2)
```

```{r}
#Train 2 with the Log variables
linearmodel2 <- lm(HappinessScore ~ Region + GDP_percapita + 
                log(Arable) + log(Infantmortalityper1000births) + 
                log(PercievedCorruptionScore) + Coastlinecoastbyarearatio, 
                data = trainD)
summary(linearmodel2)
```
```{r}
#Test 2
predict(linearmodel2, newdata = testD)
training_MSE2 <- mean(linearmodel2$residuals^2)
training_MSE2
```
```{r}
#Residuals 2
par(mfrow = c(1, 2))
plot(linearmodel2, 1:2)
```

